<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>senatorInfo</title>
    <link rel="stylesheet" href="style.css">
  </head> 
    
<body>
    
    <div>
        <div>
        <h1 id="countdem"></h1>
        <ul id="demleaders"></ul>
        </div>
        <div>
        <h1 id="countrep"></h1>
        <ul id="repleaders"></ul>
        </div>
        <div>
            <h1 id="countind"></h1>
            <ul id="indleaders"></ul>
        </div>
    </div>

 <div id="id01"></div>   
    
<script>


//This variables is used to store the data parsed from the json file.       

var senatorArray;
    

// This XMLHttpRequest is used to parse info from the first json file. 
var xmlhttp = new XMLHttpRequest();
var url = "senators.json";   


xmlhttp.onreadystatechange = function() {
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        
        //Parse the JSON data to a JavaScript variable. 
        var parsedData = JSON.parse(xmlhttp.responseText);    
        // These functions are defined below and deal with the JSON data read from the file. 
        DemRepCount(parsedData);
        senatorInfo(parsedData); 
    }
};

xmlhttp.open("GET", url, true);
xmlhttp.send();


//onclick function for buttons in senator table
function ClickFunction(tw, yt) {
  alert(`Twitter: ${tw} \nYoutube: ${yt}`);
}


//function to count the total amount of democrats and republicans and check for leadership roles
function DemRepCount(obj) {
    let demcount, repcount, indcount, demli, repli, indli;

    senatorArray  = obj.objects;
    demcount = 0;
    repcount = 0;
    indcount = 0;
    demli = "";
    repli = "";
    indli = "";

    //iterates through data and counts number of senators in each party
    for (var i=0; i<senatorArray.length; i++) {
        var party = senatorArray[i].party;
        if (party == "Democrat") {
            demcount ++;
        }
        else if (party == "Republican") {
            repcount ++;
        }
        else if (party == "Independent") {
            indcount ++;
        }

        //checks for party leaders and formats name/role for list
        var leadership_title = senatorArray[i].leadership_title;
        var firstName = senatorArray[i].person.firstname;
        var lastName = senatorArray[i].person.lastname;

        if (leadership_title != null){
            if (party == "Democrat") {
                demli +=
                `<li>${leadership_title}: ${firstName} ${lastName} (${party})</li>`;
            }
            if (party == "Republican") {
                repli += 
                `<li>${leadership_title}: ${firstName} ${lastName} (${party})</li>`;
            }
            if (party == "Independent") {
                indli += 
                `<li>${leadership_title}: ${firstName} ${lastName} (${party})</li>`;
            }
        }

    }

    //adds count of senators to heading, and role/name to lists
    document.getElementById("demleaders").innerHTML = demli;
    document.getElementById("repleaders").innerHTML = repli;
    document.getElementById("indleaders").innerHTML = indli;
    document.getElementById("countdem").innerHTML = `Count of Democrat Senators: ${demcount}`;
    document.getElementById("countrep").innerHTML = `Count of Republican Senators: ${repcount}`;
    document.getElementById("countind").innerHTML = `Count of Independent Senators: ${indcount}`;
}


// This function is used to read the data stored from the daily json file and display it in a table. 
function senatorInfo(obj) {
       
    senatorArray = obj.objects;
    
    var contact_out = "<table>";
    contact_out += "<caption>List of Senators</caption><tr><th>First Name</th><th>Last Name</th><th>Party</th><th>State</th><th>Gender</th><th>Rank</th><th>More</th></tr>";    
    // Then iterate through the array and populate table rows and columns .
    for (var i=0; i <senatorArray.length; i++) 
    {    
        twitid = senatorArray[i].person.twitterid;
        ytid = senatorArray[i].person.youtubeid;
        
        var firstName = senatorArray[i].person.firstname;
        var lastName = senatorArray[i].person.lastname;
        var party = senatorArray[i].party;
        var state = senatorArray[i].state;
        var gender = senatorArray[i].person.gender_label;
        var rank = senatorArray[i].senator_rank_label;
        
        contact_out += "<tr><td>" +
        firstName +
        "</td><td>" +
        lastName +
        "</td><td>" +
        party +
        "</td><td>" +
        state +
        "</td><td>" +
        gender +
        "</td><td>" +
        rank +
        "</td><td>" +
        `<button type='button' class='moreinfo' onclick='ClickFunction()'>Click for more information</button></tr>`;
        
    }
    
    // Close the table element.
    contact_out += "</table>";    
    document.getElementById("id01").innerHTML = contact_out;
    
}      
    


    
    
</script>
    
    
    

    
    
</body>
</html> 
